<!doctype html><html lang="en"><head><meta http-equiv="Content-type" content="text/html;charset=UTF-8"><meta name="Viewport" content="width=device-width,initial-scale=1,maximum-scale=1.0"><meta name="Description" content="Homepage of Richard Wossal. Weeks of hacking can save you hours of planning."><title>The Joy Of Debugging | r-wos.org</title> <style>
    * { line-height: 140%; }
    @-moz-keyframes blink {
 0% {
   opacity: 1;
 }
 50% {
   opacity: 0;
 }
 100% {
   opacity: 1;
 }
}

@-webkit-keyframes blink {
 0% {
   opacity: 1;
 }
 50% {
   opacity: 0;
 }
 100% {
   opacity: 1;
 }
}

@-o-keyframes blink {
 0% {
   opacity: 1;
 }
 50% {
   opacity: 0;
 }
 100% {
   opacity: 1;
 }
}

@keyframes blink {
 0% {
    opacity: 1;
 }
 50% {
    opacity: 0;
 }
 100% {
    opacity: 1;
 }
}

blink {
  display: inline;
  -webkit-animation: blink 1s steps(1) infinite;
  -moz-animation: blink 1s steps(1) infinite;
  -o-animation: blink 1s steps(1) infinite;
  animation: blink 1s steps(1) infinite;
}

    </style></head><body style="margin:15px auto;max-width:40em"> <nav> <a href="/">Home</a> - <a href="/blog">Blog</a> - <a href="/feed.xml">RSS</a> - <a href="/hacks">Hacks</a> - <a href="/about">About</a> </nav> <main><h1>The Joy Of Debugging</h1><p><time datetime="2011-08-07">2011-08-07</time></p><p>I tested everything. I ran through every line thrice to make sure it was right. I hooked up gdb. I looked at wikis, example implementations, the reference documentation. I googled. And yet I couldn't seem to get alpha blended blitting to work.</p><p>I have two (or more) surfaces (SDL terminology, think "screen buffer") and want to blit one onto the other, but with 50% opacity. There is nothing fancy about it - you just set a per-surface alpha value of 127 to the "top" surface and blit it onto the "bottom" one. Two lines of code, plus error handling. Easy. Trivial. <em>Why the fucking hell doesn't this work in my fucking program, for the fucking love of God?</em>.</p><p>After about 2 hours of checking every function call, I switched into "monkey with a typewriter" mode. Randomly erasing and inserting stuff. Randomly changing things. Randomly eating bananas.</p><p>Nothing. Everything else worked just fine - I just could not get the friggin' surfaces to blend onto each other, no matter what I tried.</p><p>So, I lit a cigarette and then it came to me... <em>The ring buffer!</em></p><p><img class="size-full wp-image-495" title="Eureka" src="http://r-wos.org/media/image_2.png" alt="Eureka" width="451" height="426"/></p><p>Yes, my to-be-blended surfaces came out of a ring buffer. Yes, there was the bug. It just returned the same surface over and over again - so I successfully blitted the same screens on top of each other. With 50% opacity. A graphical effect commonly known as "resource-wasting transparency-cancelling blending" (not a very catchy name, I know).</p><p>So, the morale of the story is: check your ring buffer implementations first.</p><p>Uh... or something like that, anyway.</p><hr><h2>See Also</h2><p>Previously: <a href="/blog/where-s-my-xor">Where's My XOR?</a></p><p>Next up: <a href="/blog/screenshot-monday-0">Screenshot Monday 0</a></p><p> The machine thinks that the Web-Log entries <a href="/blog/the-joy-of-debugging">The Joy Of Debugging</a>, <a href="/blog/ludum-dare-26-postmortem">26th Ludum Dare - Postmortem</a>, and <a href="/blog/purely-functional-games">Purely Functional Games</a> might be related to the topic so eloquently discussed above. The machine is sometimes right.</p></main></body></html>